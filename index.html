<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />  
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pinch‑Resizable Google Sheet</title>
  <!-- Bootstrap CSS -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
  <!-- Hammer.js for pinch gestures -->
  <script src="https://cdn.jsdelivr.net/npm/hammerjs@2.0.8/hammer.min.js"></script>
  <style>
    html, body {
      margin: 0; height: 100%; overflow: hidden;
      font-family: sans-serif;
    }
    header {
      height: 50px; line-height: 50px;
      text-align: center; background: #f5f5f5;
      border-bottom: 1px solid #ddd;
    }
    #sheet-container {
      position: relative;
      width: 100%; height: calc(100vh - 50px);
      touch-action: none;      /* capture pinch instead of page zoom */
      overflow: hidden;
      border: 1px solid #ccc;
      box-sizing: border-box;
      transform-origin: 0 0;   /* scale from top‑left by default */
      transition: transform 0.05s ease-out;
    }
    #sheet-container iframe {
      position: absolute; top: 0; left: 0;
      width: 100%; height: 100%;
      border: none;
    }
  </style>
</head>
<body>
  <header>My Google Sheet</header>

  <div id="sheet-container">
    <iframe
      src="https://docs.google.com/spreadsheets/d/e/2PACX-1vQaEtCECClItFOJuGcyfporW-4sGimqVBRuqGdV5DWQCzogiZB-wBTnUDlB44rQlA/pubhtml?widget=true&amp;headers=false"
      scrolling="yes"
    ></iframe>
  </div>

  <script>
    // Initialize Hammer on the container
    const container = document.getElementById('sheet-container');
    const mc = new Hammer.Manager(container);
    mc.add(new Hammer.Pinch());

    let currentScale = 1;
    let startScale = 1;

    mc.on('pinchstart', e => {
      startScale = currentScale;
    });

    mc.on('pinchmove', e => {
      // Calculate new scale, clamped between 0.5× and 3×
      currentScale = Math.max(0.5, Math.min(startScale * e.scale, 3));
      // Use the pinch center as transform-origin for natural zoom
      container.style.transformOrigin =
        (e.center.x - container.getBoundingClientRect().left) + 'px '
        + (e.center.y - container.getBoundingClientRect().top) + 'px';
      container.style.transform = 'scale(' + currentScale + ')';
    });
  </script>
</body>
</html>
